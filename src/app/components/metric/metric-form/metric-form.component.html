<h1 mat-dialog-title>
	<div *ngIf="data.isEdit; then editTitle else createTitle"></div>
	<ng-template #editTitle>
		Editing Metric:
		<span style="font-size: 70%;"> {{ data.resource._id }}</span>
	</ng-template>
	<ng-template #createTitle>
		Creating New Metric
	</ng-template>
	<button mat-dialog-close mat-icon-button class="pull-right" style="font-size: 150%" (click)="onCancelClick()">&times;</button>
</h1>
<form [formGroup]="form">
	<mat-tab-group dynamicHeight>
		<mat-tab label="General" class="mviwo-unselectable">
			<div mat-dialog-content>
				<div class="row newL">
					<div class="col-lg-9 col-md-9 col-sm-9 col-xs-12">
						<mat-form-field floatLabel="auto">
							<input matInput type="text" placeholder="Metric Name" formControlName="tfName" required [maxLength]="rules.nameMaxLength"
							    cdkFocusInitial>
							<mat-hint align="end">
								characters left: {{ rules.nameMaxLength - form.get('tfName').value.length }}
							</mat-hint>
							<mat-error *ngIf="form.get('tfName').invalid">
								{{ getNameErrorMessage() }}
							</mat-error>
						</mat-form-field>
					</div>
					<!-- col 1 -->
					<div class="col-lg-3 col-md-3 col-sm-3 col-xs-12">
						<mat-slide-toggle matTooltip="must be given a value" formControlName="cbRequired">
							Required
						</mat-slide-toggle>
					</div>
					<!-- col 2 -->
				</div>
				<!-- row 1 -->
				<div class="row newL">
					<div class="col-lg-12-col-md-12 col-sm-12 col-xs-12">
						<mat-form-field floatLabel="auto">
							<textarea matInput placeholder="Description" formControlName="taDescription" matTextareaAutosize [maxLength]="rules.descriptionMaxLength"></textarea>
							<mat-hint align="end">
								characters left: {{ (form.get('taDescription').value) ? rules.descriptionMaxLength - form.get('taDescription').value.length
								: rules.descriptionMaxLength }}
							</mat-hint>
						</mat-form-field>
					</div>
				</div>
				<!-- row 2 -->
			</div>
		</mat-tab>
		<!-- general info tab -->
		<mat-tab label="Input" class="mviwo-unselectable">
			<div mat-dialog-content>
				<div class="row newL">
					<div class="col-lg-8 col-md-8 col-sm-8 col-xs-12">
						<mat-form-field floatLabel="auto" style="padding: 10px; border-radius: 5px; border:1px solid lightgrey">
							<mat-select placeholder="Date Type" required formControlName="slDataType" style="width:100%" (selectionChange)="onDataTypeChange()">
								<mat-option *ngIf="!data.isEdit && !form.get('slDataType').value">Select a datatype..</mat-option>
								<mat-option *ngFor="let dType of dataTypes" [matTooltip]="dType.desc" [matTooltipShowDelay]="500" [value]="dType.name">
									{{ dType.simpleName }}
								</mat-option>
							</mat-select>
							<mat-error *ngIf="form.get('slDataType').invalid">
								must select a data type!
							</mat-error>
						</mat-form-field>
					</div>
					<!-- col 1 -->
					<div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
						<div formGroupName="grpEnumParams" *ngIf="form.get('slDataType').value === 'enum'">
							<mat-slide-toggle formControlName="cbMultiple">
								Multiple Choice
							</mat-slide-toggle>
						</div>
						<div *ngIf="form.get('slDataType').value === 'number'">
							<div class="row" style="padding: 10px">
								<mat-select placeholder="Apply preset..">
									<mat-option *ngFor="let preset of numberPresets" (click)="onPresetPicked(preset)">
										{{ preset.name }}
									</mat-option>
								</mat-select>
							</div>
							<div class="row" style="padding: 10px">
								<div formGroupName="grpNumberParams">
									<mat-slide-toggle formControlName="cbFreeInput">
										Free Input
									</mat-slide-toggle>
								</div>
							</div>
						</div>
						<div *ngIf="form.get('slDataType').value === 'string'">
							<div class="row" style="padding: 10px">
								<div class="col-lg-12">
									<div formGroupName="grpStringParams">
										<mat-slide-toggle formControlName="cbLineBreaks" (change)="onLineBreaksTicked()">
											Line Breaks
										</mat-slide-toggle>
									</div>
								</div>
							</div>
							<div class="row" style="padding: 10px">
								<div class="col-lg-12">
									<div formGroupName="grpStringParams">
										<mat-slide-toggle formControlName="cbEmail" (change)="onEmailTicked()">
											Email Field
										</mat-slide-toggle>
									</div>
								</div>
							</div>
						</div>
						<div *ngIf="form.get('slDataType').value === 'date'">
							<div class="row" style="padding: 10px">
								<div class="col-lg-12">
									<div formGroupName="grpDateParams">
										<mat-slide-toggle formControlName="cbIsMinDateCurrent" (change)="onMinMaxCurrentChange('min')">
											Min Current
										</mat-slide-toggle>
									</div>
								</div>
							</div>
							<div class="row" style="padding: 10px">
								<div class="col-lg-12">
									<div formGroupName="grpDateParams">
										<mat-slide-toggle formControlName="cbIsMaxDateCurrent" (change)="onMinMaxCurrentChange('max')">
											Max Current
										</mat-slide-toggle>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- col 2 -->
				</div>
				<!-- row 1-->
				<div class="row newL" *ngIf="form.get('slDataType').value">
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
						<div *ngIf="form.get('slDataType').value === 'boolean'">
							<hr>
							<div class="form-group">
								<label class="text-muted">Preview</label>
								<br>
								<mat-checkbox style="padding-left: 20px !important" color="primary" [indeterminate]="!form.get('cbRequired').value">{{ form.get('tfName').value || '{METRIC_NAME}' }}</mat-checkbox>
							</div>
						</div>
					</div>
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12" *ngIf="form.get('slDataType').value !== 'boolean'">
						<mat-form-field *ngIf="form.get('slDataType').value === 'string'" floatLabel="auto" formGroupName="grpStringParams">
							<input matInput type="text" placeholder="Hint" formControlName="tfHint" [maxlength]="rules.hintMaxLength">
							<mat-hint align="start">shown under input control</mat-hint>
							<mat-hint align="end">
								characters left: {{ (form.get('grpStringParams').get('tfHint').value) ? rules.hintMaxLength - form.get('grpStringParams').get('tfHint').value.length
								: rules.hintMaxLength }}
							</mat-hint>
						</mat-form-field>
						<mat-form-field *ngIf="form.get('slDataType').value === 'number'" floatLabel="auto" formGroupName="grpNumberParams">
							<input matInput type="number" placeholder="Minimum Value" formControlName="tfMinValue" (change)="onMinMaxValueChange('min')">
							<mat-hint align="end">default to 0</mat-hint>
							<mat-error *ngIf="form.get('grpNumberParams').get('tfMinValue').invalid">
								{{ getMinValueErrorMessage() }}
							</mat-error>
						</mat-form-field>
						<mat-form-field floatLabel="auto" *ngIf="form.get('slDataType').value === 'enum'">
							<input matInput type="text" placeholder="add list values.." [pattern]="rules.enumValuePattern" [formControl]="xxValuesInput">
							<mat-error *ngIf="xxValuesInput.invalid">
								{{ xxValuesInput.hasError('pattern') ? 'letters only!' : xxValuesInput.hasError('valueNotExists') ? 'value already in list!'
								: xxValuesInput.hasError('dependancy') ? 'minimum 2 values!' : '' }}
							</mat-error>
							<mat-icon matSuffix *ngIf="xxValuesInput.value && xxValuesInput.value.length && !xxValuesInput.hasError('pattern') && !xxValuesInput.hasError('valueNotExists')"
							    color="accent" (click)="addEnumValue()">
								<button class="btn btn-success btn-circle">
									<i class="fa fa-plus" aria-hidden="true"></i>
								</button>
							</mat-icon>
						</mat-form-field>
						<mat-form-field *ngIf="form.get('slDataType').value === 'date' && !form.get('grpDateParams').get('cbIsMinDateCurrent').value"
						    floatLabel="auto" formGroupName="grpDateParams">
							<input matInput readonly (click)="dp.open()" [matDatepicker]="dp" placeholder="Minimum Date" formControlName="dpMinDate" [max]="form.get('grpDateParams').get('dpMaxDate').value">
							<mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
							<mat-datepicker #dp></mat-datepicker>
						</mat-form-field>
						<mat-form-field *ngIf="form.get('slDataType').value === 'date' && form.get('grpDateParams').get('cbIsMinDateCurrent').value === true"
						    floatLabel="auto" formGroupName="grpDateParams">
							<span matPrefix *ngIf="form.get('grpDateParams').get('tfMinDateOffset').value > 0">+</span>
							<input type="number" matInput placeholder="Min Date Offset" formControlName="tfMinDateOffset" [step]="1">
							<span matSuffix> days</span>
							<mat-error *ngIf="form.get('grpDateParams').get('tfMinDateOffset').invalid">cannot be greater than max offset!</mat-error>
						</mat-form-field>
					</div>
					<!-- col 1 -->
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12" *ngIf="form.get('slDataType').value !== 'boolean'">
						<div *ngIf="form.get('slDataType').value === 'string'" style="min-height: 70px">
							<mat-form-field *ngIf="!form.get('grpStringParams').get('cbLineBreaks').value && !form.get('grpStringParams').get('cbEmail').value"
							    floatLabel="auto" formGroupName="grpStringParams">
								<input matInput type="text" placeholder="Pattern" formControlName="tfPattern">
								<mat-hint>enter a regular expression</mat-hint>
								<mat-error *ngIf="form.get('grpStringParams').get('tfPattern').invalid">
									{{ getPatternErrorMessage() }}
								</mat-error>
							</mat-form-field>
						</div>
						<mat-form-field *ngIf="form.get('slDataType').value === 'number'" floatLabel="auto" formGroupName="grpNumberParams">
							<input matInput type="number" placeholder="Maximum Value" formControlName="tfMaxValue" (change)="onMinMaxValueChange('max')">
							<mat-hint align="end">default to 100</mat-hint>
							<mat-error *ngIf="form.get('grpNumberParams').get('tfMaxValue').invalid">
								{{ getMaxValueErrorMessage() }}
							</mat-error>
						</mat-form-field>
						<div *ngIf="form.get('slDataType').value === 'enum'">
							<mat-label>Value List</mat-label>
							<mat-list class="xxValuesList">
								<mat-list-item style="padding-bottom: 15px; background-color: rgb(70,70,70)" *ngIf="!getxxValuesControls().length">
									<small>NO VALUES ADDED</small>
								</mat-list-item>
								<mat-list-item style="padding-bottom: 15px; background-color: rgb(70,70,70)" class="mat-elevation-z2" *ngFor="let valueCtrl of getxxValuesControls()">
									<button class="btn btn-danger btn-circle" (click)="removeEnumValue(valueCtrl)">
										<i class="fa fa-minus" aria-hidden="true"></i>
									</button>
									<span style="padding-left: 15px;">{{ valueCtrl.value }}</span>
								</mat-list-item>
							</mat-list>
						</div>
						<mat-form-field *ngIf="form.get('slDataType').value === 'date' && !form.get('grpDateParams').get('cbIsMaxDateCurrent').value"
						    floatLabel="auto" formGroupName="grpDateParams">
							<input matInput readonly (click)="dp.open()" [matDatepicker]="dp" placeholder="Maximum Date" formControlName="dpMaxDate" [min]="form.get('grpDateParams').get('dpMinDate').value">
							<mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
							<mat-datepicker #dp></mat-datepicker>
						</mat-form-field>
						<mat-form-field *ngIf="form.get('slDataType').value === 'date' && form.get('grpDateParams').get('cbIsMaxDateCurrent').value === true"
						    floatLabel="auto" formGroupName="grpDateParams">
							<span matPrefix *ngIf="form.get('grpDateParams').get('tfMaxDateOffset').value > 0">+</span>
							<input type="number" matInput placeholder="Max Date Offset" formControlName="tfMaxDateOffset" [step]="1">
							<span matSuffix> days</span>
							<mat-error *ngIf="form.get('grpDateParams').get('tfMaxDateOffset').invalid">cannot be less than min offset!</mat-error>
						</mat-form-field>
					</div>
					<!-- col 2 -->
				</div>
				<!-- row 2 -->
				<div class="row newL" *ngIf="form.get('slDataType').value && !['boolean'].includes(form.get('slDataType').value)">
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
						<form *ngIf="form.get('slDataType').value === 'enum'" ngForm>
							<hr>
							<div class="form-group">
								<label class="text-muted">Preview</label>
								<br>
								<div *ngIf="form.get('grpEnumParams').get('cbMultiple').value; then multipleChoice; else singleChoice"></div>
								<ng-template #singleChoice>
									<mat-form-field labelfloat="auto">
										<mat-select ngModel #enumPrev1="ngModel" name="enumPrev1" [placeholder]="form.get('tfName').value || '{METRIC_NAME}'" [required]="form.get('cbRequired')">
											<mat-option *ngFor="let ctrl of getxxValuesControls()" [value]="ctrl.value">
												{{ ctrl.value }}
											</mat-option>
										</mat-select>
										<mat-error *ngIf="enumPrev1.invalid">
											you must select a {{ form.get('tfName').value || '{METRIC_NAME}' | lowercase }}!
										</mat-error>
									</mat-form-field>
								</ng-template>
								<ng-template #multipleChoice>
									<mat-form-field labelfloat="auto">
										<mat-select ngModel #enumPrev2="ngModel" name="enumPrev2" [placeholder]="form.get('tfName').value || '{METRIC_NAME}'" multiple
										    [required]="form.get('cbRequired')">
											<mat-option *ngFor="let ctrl of getxxValuesControls()" [value]="ctrl.value">
												{{ ctrl.value }}
											</mat-option>
										</mat-select>
										<mat-error *ngIf="enumPrev2.invalid">
											you must select {{ form.get('tfName').value || '{METRIC_NAME}' | lowercase }}!
										</mat-error>
									</mat-form-field>
								</ng-template>
							</div>
						</form>
						<form *ngIf="form.get('slDataType').value === 'date'">
							<hr>
							<label class="text-muted">Preview</label>
							<br>
							<mat-form-field>
								<input matInput readonly (click)="picker.open()"
										#pickertf="ngModel" ngModel name="pickertf" [required]="form.get('cbRequired').value" [min]="form.get('grpDateParams').get('cbIsMinDateCurrent').value ?
										dates.offsetDate(form.get('grpDateParams').get('tfMinDateOffset').value) :
										form.get('grpDateParams').get('dpMinDate').value" [max]="form.get('grpDateParams').get('cbIsMaxDateCurrent').value ?
										dates.offsetDate(form.get('grpDateParams').get('tfMaxDateOffset').value) :
										form.get('grpDateParams').get('dpMaxDate').value" [matDatepicker]="picker" [placeholder]="form.get('tfName').value || '{METRIC_NAME}'">
								<mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
								<mat-datepicker #picker></mat-datepicker>
								<mat-error>{{ pickertf.hasError('required') ? 'you must enter a ' + (form.get('tfName').value || '{METRIC_NAME}' | lowercase) + '!' : 'invalid date!' }}</mat-error>
							</mat-form-field>
						</form>
					</div>
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
						<mat-form-field *ngIf="form.get('slDataType').value === 'string'" floatLabel="auto" formGroupName="grpStringParams">
							<input matInput type="number" placeholder="Minimum Length" formControlName="tfMinLength" min="0" (change)="onMinMaxLengthChange('min')">
							<mat-hint align="end">defaults to 0</mat-hint>
							<mat-error *ngIf="form.get('grpStringParams').get('tfMinLength').invalid">
								{{ getMinLengthErrorMessage() }}
							</mat-error>
						</mat-form-field>
						<mat-form-field *ngIf="form.get('slDataType').value === 'number'" floatLabel="auto" formGroupName="grpNumberParams">
							<input matInput type="number" placeholder="Step" formControlName="tfStep">
							<mat-hint align="start">gap between values</mat-hint>
							<mat-hint align="end">defaults to 1</mat-hint>
							<mat-error *ngIf="form.get('grpNumberParams').get('tfStep').invalid">
								{{ getStepErrorMessage() }}
							</mat-error>
						</mat-form-field>
					</div>
					<!-- col 1 -->
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
						<mat-form-field *ngIf="form.get('slDataType').value === 'string'" floatLabel="auto" formGroupName="grpStringParams">
							<input matInput type="number" placeholder="Maximum Length" formControlName="tfMaxLength" min="1" (change)="onMinMaxLengthChange('max')">
							<mat-error *ngIf="form.get('grpStringParams').get('tfMaxLength').invalid">
								{{ getMaxLengthErrorMessage() }}
							</mat-error>
						</mat-form-field>
						<mat-form-field *ngIf="form.get('slDataType').value === 'number'" floatLabel="auto" formGroupName="grpNumberParams">
							<input matInput type="number" placeholder="Tick Interval" formControlName="tfTickInterval" min="0">
							<mat-hint align="start">tick every _ values</mat-hint>
							<mat-hint align="end">defaults to 1</mat-hint>
							<mat-error *ngIf="form.get('grpNumberParams').get('tfTickInterval').invalid">
								{{ getTickIntervalErrorMessage() }}
							</mat-error>
						</mat-form-field>
					</div>
					<!-- col 2 -->
				</div>
				<!-- row 3 -->
				<div class="row newL" *ngIf="form.get('slDataType').value && !['boolean', 'date'].includes(form.get('slDataType').value)">
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
					</div>
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12" *ngIf="form.get('slDataType').value === 'number'">
						<mat-form-field floatLabel="auto" formGroupName="grpNumberParams">
							<input matInput placeholder="Prefix" type="text" formControlName="tfPrefix">
							<mat-hint align="right">displayed before value</mat-hint>
						</mat-form-field>
					</div>
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12" *ngIf="form.get('slDataType').value === 'number'">
						<mat-form-field floatLabel="auto" formGroupName="grpNumberParams">
							<input matInput placeholder="Postfix" type="text" formControlName="tfPostfix">
							<mat-hint align="right">displayed after value</mat-hint>
						</mat-form-field>
					</div>
				</div>
				<!-- row 4 -->
				<div class="row" *ngIf="form.get('slDataType').value && !['boolean', 'date'].includes(form.get('slDataType').value)">
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
						<form ngForm *ngIf="form.get('slDataType').value === 'number'">
							<hr>
							<div form-group>
								<label for="sliderPrev" class="text-muted">Preview</label>
								<br>
								<mat-label>{{ form.get('tfName').value || '{METRIC_NAME}' }}</mat-label>
								<div class="row">
									<div class="col-md-8 col-sm-8 col-xs-8">
										<mat-slider style="width: 100%" [(ngModel)]="sliderPrev" [min]="form.get('grpNumberParams').get('tfMinValue').value" [max]="form.get('grpNumberParams').get('tfMaxValue').value"
										    [step]="form.get('grpNumberParams').get('tfStep').value" [tickInterval]="form.get('grpNumberParams').get('tfTickInterval').value || 1"
										    thumbLabel="true" name="sliderPrev">
										</mat-slider>
									</div>
									<div class="col-md-4 col-sm-4 col-xs-4">
										<mat-label *ngIf="!form.get('grpNumberParams').get('cbFreeInput').value">
											{{ ((form.get('grpNumberParams').get('tfPrefix').value) ? (form.get('grpNumberParams').get('tfPrefix').value + ' ') : '')
											+ sliderPrev + ((form.get('grpNumberParams').get('tfPostfix').value) ? (' ' + form.get('grpNumberParams').get('tfPostfix').value)
											: '') }}
										</mat-label>
										<mat-form-field class="freeInput" *ngIf="form.get('grpNumberParams').get('cbFreeInput').value === true" style="width: 100%">
											<span matPrefix>{{ form.get('grpNumberParams').get('tfPrefix').value }} </span>
											<input matInput type="number" [(ngModel)]="sliderPrev" name="sliderPrevInput" min="{{form.get('grpNumberParams').get('tfMinValue').value || 0}}"
											    max="{{form.get('grpNumberParams').get('tfMaxValue').value || 100}}" [step]="form.get('grpNumberParams').get('tfStep').value || 1"
											    (keyup)="sliderPrev = form.get('grpNumberParams').get('tfMinValue').value && sliderPrev < form.get('grpNumberParams').get('tfMinValue').value ? form.get('grpNumberParams').get('tfMinValue').value :
												!form.get('grpNumberParams').get('tfMinValue').value && sliderPrev < 0 ? 0 :
												form.get('grpNumberParams').get('tfMaxValue').value && form.get('grpNumberParams').get('tfMaxValue').value < sliderPrev ? form.get('grpNumberParams').get('tfMaxValue').value :
												!form.get('grpNumberParams').get('tfMaxValue').value && 100 < sliderPrev ? 100 : sliderPrev">
											<span matSuffix>{{ form.get('grpNumberParams').get('tfPostfix').value }}</span>
										</mat-form-field>
									</div>
								</div>
							</div>
						</form>
						<form ngForm *ngIf="form.get('slDataType').value === 'string'">
							<hr>
							<div class="form-group">
								<label class="text-muted">Preview</label>
								<div *ngIf="form.get('grpStringParams').get('cbLineBreaks').value; then textarea; else inputfield"></div>
								<ng-template #inputfield>
									<mat-form-field floatLabel="auto">
										<input matInput ngModel #textfieldPrev="ngModel" name="textfieldPrev" type="text" [placeholder]="form.get('tfName').value || '{METRIC_NAME}'"
										    [required]="form.get('cbRequired').value" [minlength]="form.get('grpStringParams').get('tfMinLength').value" [maxlength]="form.get('grpStringParams').get('tfMaxLength').value"
										    [email]="form.get('grpStringParams').get('cbEmail').value" [pattern]="(form.get('grpStringParams').get('cbEmail').value) ? '' : form.get('grpStringParams').get('tfPattern').value">
										<mat-hint align="start">{{ form.get('grpStringParams').get('tfHint').value }}</mat-hint>
										<mat-hint align="end" *ngIf="form.get('grpStringParams').get('tfMaxLength').value">
											characters left: {{ (textfieldPrev.value) ? form.get('grpStringParams').get('tfMaxLength').value - textfieldPrev.value.length
											: form.get('grpStringParams').get('tfMaxLength').value }}
										</mat-hint>
										<mat-error *ngIf="textfieldPrev.invalid">
											{{ textfieldPrev.hasError('required') ? 'you must enter ' + (form.get('tfName').value || '{METRIC_NAME}' | lowercase) + '!'
											: textfieldPrev.hasError('email') ? 'invalid email address!' : textfieldPrev.hasError('pattern') ? 'invalid value!'
											: textfieldPrev.hasError('minlength') ? 'too short!' : '' }}
										</mat-error>
									</mat-form-field>
								</ng-template>
								<ng-template #textarea>
									<mat-form-field floatLabel="auto">
										<textarea matInput matTextareaAutosize ngModel #textareaPrev="ngModel" [placeholder]="form.get('tfName').value" name="textareaPrev"
										    [required]="form.get('cbRequired').value" [maxlength]="form.get('grpStringParams').get('tfMaxLength').value"></textarea>
										<mat-hint align="start">{{ form.get('grpStringParams').get('tfHint').value }}</mat-hint>
										<mat-hint align="end" *ngIf="form.get('grpStringParams').get('tfMaxLength').value">
											characters left: {{ (textareaPrev.value) ? form.get('grpStringParams').get('tfMaxLength').value - textareaPrev.value.length
											: form.get('grpStringParams').get('tfMaxLength').value }}
										</mat-hint>
									</mat-form-field>
								</ng-template>
							</div>
						</form>
					</div>
				</div>
				<!-- row 5 -->
			</div>
		</mat-tab>
		<mat-tab label="Group/s" class="mviwo-unselectable">
			<div mat-dialog-content>
				<div class="row newL" style="max-height: 500px; min-height: 300px">
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
						<div class="panel panel-info" dnd-sortable-container [sortableData]="metricGroups">
							<mat-label>Available Groups</mat-label>
							<div class="scroll-div-sm panel-body" dnd-draggable dnd-droppable [dropZones]="['zone0']">
								<ul class="list-group">
									<li *ngIf="!metricGroups || !metricGroups.length" class="empty-list-item list-group-item">
										drag here to deselect..
									</li>
									<li *ngFor="let ctrl of metricGroups; let i = index" class="list-group-item" dnd-sortable [sortableIndex]="i" [dragEnabled]="true"
									    [dragData]="ctrl" (onDropSuccess)="onGroupDragSuccessful()">
										<span dnd-draggable-handle style="padding-right: 5px">
											<i class="fa fa-ellipsis-v" aria-hidden="true"></i>
										</span>
										{{ ctrl.value.name }}
										<button type="button" class="btn btn-success btn-circle btn-sm pull-right" (click)="addGroup(ctrl)">
											<i class="fa fa-plus" aria-hidden="true"></i>
										</button>
									</li>
								</ul>
							</div>
						</div>
					</div>
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
						<div class="panel panel-info" dnd-sortable-container [sortableData]="getxxGroupsControls()">
							<mat-label>Selected Groups</mat-label>
							<div class="scroll-div-sm panel-body" dnd-draggable dnd-droppable [dropZones]="['zone0']">
								<ul class="list-group">
									<li *ngIf="!getxxGroupsControls().length" class="empty-list-item list-group-item">
										drag here to select..
									</li>
									<li *ngFor="let ctrl of getxxGroupsControls(); let i = index" dnd-sortable [sortableIndex]="i" [dragEnabled]="true" [dragData]="ctrl"
									    class="list-group-item" (onDropSuccess)="onGroupDragSuccessful()">
										<span dnd-draggable-handle style="padding-right: 5px">
											<i class="fa fa-ellipsis-v" aria-hidden="true"></i>
										</span>
										{{ ctrl.value.name }}
										<button type="button" class="btn btn-danger btn-circle btn-sm pull-right" (click)="removeGroup(ctrl)">
											<i class="fa fa-minus" aria-hidden="true"></i>
										</button>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</mat-tab>
	</mat-tab-group>
</form>
<div mat-dialog-actions class="modal-footer newL">
	<button mat-raised-button color="primary" matTooltip="save changes" type="button" [disabled]="form.invalid || form.pristine"
	    (click)="onSaveClick()">
		<i class="fa fa-floppy-o" aria-hidden="true"></i>
	</button>
	<button mat-raised-button color="accent" matTooltip="undo changes" type="button" [disabled]="form.pristine" (click)="onResetClick()">
		<i class="fa fa-undo" aria-hidden="true"></i>
	</button>
	<button mat-raised-button matTooltip="cancel" type="button" (click)="onCancelClick()">
		<i class="fa fa-times" aria-hidden="true"></i>
	</button>
</div>
